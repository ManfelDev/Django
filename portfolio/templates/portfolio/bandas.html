<!-- FICHEIRO: portfolio/templates/portfolio/bandas.html -->
{% extends 'portfolio/base.html' %}

{% load static %}
{% block extra_styles %}
<link rel="stylesheet" href="{% static 'css_portfolio/apis.css' %}">
<link rel="stylesheet" href="{% static 'css_portfolio/form.css' %}">
{% endblock %}

{% block main %}
<h2>Bands Management</h2>

{% if messages %}
    {% for message in messages %}
        <div class="error-message" style="background-color: {% if message.tags == 'success' %}#2d5a2d{% else %}#5a2d2d{% endif %}; margin-bottom: 20px;">
            <p>{{ message }}</p>
        </div>
    {% endfor %}
{% endif %}

<div class="external-api-info">
    <p>This section demonstrates band management through external API calls. Bands are the root entities that contain albums and songs.</p>
    <p><strong>API Endpoint:</strong> <a href="https://a22202884.pw.deisi.ulusofona.pt/bandas/api/bandas/" target="_blank"><code>https://a22202884.pw.deisi.ulusofona.pt/bandas/api/bandas/</code></a></p>
    <p><strong>API Documentation:</strong> <a href="https://a22202884.pw.deisi.ulusofona.pt/bandas/api/docs" target="_blank">View Complete API Documentation</a></p>
</div>

<div class="api-nav">
    <a href="{% url 'portfolio:bandas_externas' %}" class="custom-button active">Manage Bands</a>
    <a href="{% url 'portfolio:albuns_externos' %}" class="custom-button">Manage Albums</a>
    <a href="{% url 'portfolio:musicas_externas' %}" class="custom-button">Manage Songs</a>
</div>

<div class="create-form">
    <h4>Create New Band</h4>
    <form method="post" action="{% url 'portfolio:criar_banda_externa' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ banda_form.as_p }}
        <input type="submit" value="Create Band" class="custom-button">
    </form>
</div>

{% if dados %}
    <h4 class="items-count">Current Bands from External API ({{ dados|length }} found)</h4>
    
    <div class="api-grid">
        {% for banda in dados %}
            <div class="api-card">
                <div class="music-icon">ðŸŽ¸</div>
                
                <div class="api-card-content">
                    <h4>{{ banda.nome }}</h4>
                    
                    {% if banda.foto %}
                        <div class="image-section">
                            <p><strong>Band Photo:</strong></p>
                            <img src="{{ banda.foto }}" alt="{{ banda.nome }} photo" class="card-image">
                        </div>
                    {% endif %}
                    
                    <p><strong>Number of Members:</strong> {{ banda.nr_elementos }}</p>
                    <p><strong>Year Created:</strong> {{ banda.ano_criacao }}</p>
                    <p><strong>Band ID:</strong> {{ banda.id }}</p>
                </div>
                
                <div class="api-endpoint">
                    <strong>API Endpoint:</strong> /api/bandas/{{ banda.id }}/
                </div>
                
                <div class="api-actions">
                    <a href="{% url 'portfolio:bandas_externas_id' banda.id %}" class="custom-button">View Details</a>
                    <a href="{% url 'portfolio:editar_banda_externa' banda.id %}" class="custom-button">Edit (PUT)</a>
                    <a href="{% url 'portfolio:apagar_banda_externa' banda.id %}" class="custom-button danger-button" onclick="return confirm('Delete this band?')">Delete</a>
                </div>
            </div>
        {% endfor %}
    </div>
    
    <div style="margin-top: 30px; padding: 20px; background-color: #1f1f1f; border-radius: 15px; border-left: 4px solid #bb86fc;">
        <h4 style="color: #bb86fc; margin-bottom: 15px;">Bands API Integration Details</h4>
        <p><strong>Data Structure:</strong> Each band contains name, member count, creation year, and optional photo</p>
        <p><strong>File Handling:</strong> Supports band photo uploads through multipart/form-data requests</p>
        <p><strong>Root Entity:</strong> Bands serve as the parent entities for albums and songs in the music hierarchy</p>
        <p><strong>Musical Groups:</strong> Represents complete musical organizations with member and timeline information</p>
        <p><strong>CRUD Operations:</strong> Complete Create, Read, Update, Delete functionality with proper HTTP status handling</p>
    </div>
{% else %}
    <div class="no-data">
        <h4>No Bands Found</h4>
        <p>No bands are currently available from the external API.</p>
    </div>
{% endif %}

<div style="margin-top: 40px; text-align: center;">
    <a href="{% url 'portfolio:apis' %}" class="custom-button">Back to APIs Overview</a>
</div>
{% endblock %}