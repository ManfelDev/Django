{% extends 'portfolio/base.html' %}

{% load static %}
{% block extra_styles %}
<link rel="stylesheet" href="{% static 'css_portfolio/projeto.css' %}">
<link rel="stylesheet" href="{% static 'css_portfolio/apis.css' %}">
{% endblock %}

{% block main %}
<section class="project-section">
    <h2 class="project-title">{{ dados.nome }}</h2>
    
    <div class="external-api-info" style="margin-bottom: 30px;">
        <p><strong>Data Source:</strong> External RESTful API</p>
        <p><strong>API Endpoint:</strong> <a href="https://a22202884.pw.deisi.ulusofona.pt/bandas/api/musicas/{{ dados.id }}/" target="_blank"><code>GET /api/musicas/{{ dados.id }}/</code></a></p>
        <p>This page demonstrates fetching detailed information about a specific song from an external API using individual resource endpoints. The song data includes album and band relationships with complete musical metadata.</p>
    </div>
    
    <div style="max-width: 800px; margin: 0 auto;">
        <div class="project-final-box">
            <div class="project-info-item">
                <p><strong>Song Name:</strong> {{ dados.nome }}</p>
            </div>
            <div class="project-info-item">
                <p><strong>Duration:</strong> {{ dados.duration }} seconds</p>
            </div>
            <div class="project-info-item">
                {% if dados.album.nome %}
                    <p><strong>Album:</strong> {{ dados.album.nome }}</p>
                {% else %}
                    <p><strong>Album ID:</strong> {{ dados.album }}</p>
                {% endif %}
            </div>
            {% if dados.album.nome %}
                <div class="project-info-item">
                    <p><strong>Album ID:</strong> {{ dados.album.id }}</p>
                </div>
                <div class="project-info-item">
                    <p><strong>Album Songs:</strong> {{ dados.album.nr_musicas }}</p>
                </div>
                {% if dados.album.spotify_link %}
                    <div class="project-info-item">
                        <p><strong>Album Spotify:</strong> 
                            {% if 'http' in dados.album.spotify_link %}
                                <a href="{{ dados.album.spotify_link }}" target="_blank" style="color: #1db954;">Listen to Album</a>
                            {% else %}
                                <a href="https://{{ dados.album.spotify_link }}" target="_blank" style="color: #1db954;">Listen to Album</a>
                            {% endif %}
                        </p>
                    </div>
                {% endif %}
            {% endif %}
            <div class="project-info-item">
                <p><strong>Song ID:</strong> {{ dados.id }}</p>
            </div>
            {% if dados.spotify_link %}
                <div class="project-info-item">
                    <p><strong>Song Spotify:</strong> 
                        {% if 'http' in dados.spotify_link %}
                            <a href="{{ dados.spotify_link }}" target="_blank" style="color: #1db954;">Listen on Spotify</a>
                        {% else %}
                            <a href="https://{{ dados.spotify_link }}" target="_blank" style="color: #1db954;">Listen on Spotify</a>
                        {% endif %}
                    </p>
                </div>
            {% endif %}
            {% if dados.lyrics %}
                <div class="project-info-item">
                    <p><strong>Lyrics:</strong></p>
                    <div style="background-color: #2b2b2b; padding: 20px; border-radius: 10px; white-space: pre-line; max-height: 400px; overflow-y: auto; margin-top: 10px; border: 1px solid #444;">{{ dados.lyrics }}</div>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="button-wrapper" style="margin-top: 30px; gap: 15px;">
        <a href="{% url 'portfolio:musicas_externas' %}" class="custom-button">Back to Songs</a>
        <a href="{% url 'portfolio:editar_musica_externa' dados.id %}" class="custom-button">Edit Song</a>
        <a href="{% url 'portfolio:apagar_musica_externa' dados.id %}" class="custom-button danger-button" onclick="return confirm('Delete this song?')">Delete Song</a>
    </div>
</section>
{% endblock %}